(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{502:function(a,e,t){"use strict";t.r(e);var s=t(45),r=Object(s.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"package-json-依赖管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#package-json-依赖管理"}},[a._v("#")]),a._v(" Package.json 依赖管理")]),a._v(" "),e("p",[a._v("我们使用 npm 安装包的时候，常常会安装很多依赖，等到项目上线后，项目代码一般不会改动了。可依赖包却也在不断地更新。那么我们依赖包是否需要同样不断更新？")]),a._v(" "),e("ul",[e("li",[a._v("是否需要升级依赖包")]),a._v(" "),e("li",[a._v("如何升级依赖包")])]),a._v(" "),e("h2",{attrs:{id:"是否需要升级依赖包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#是否需要升级依赖包"}},[a._v("#")]),a._v(" 是否需要升级依赖包")]),a._v(" "),e("p",[a._v("如果站在用户的角度，其实并不关心项目中的依赖，只要程序能够正常运行就好了，如果升级后导致了更多的问题，倒还会引起用户的反感。")]),a._v(" "),e("p",[a._v("开发者和用户不一样，由于前端更新换代非常快，库的更新也特别快，保持依赖库的更新，可以起到优化项目，利于维护等好处。")]),a._v(" "),e("p",[e("strong",[a._v("优化项目")]),a._v("：新版本的库一般是对旧版本库的一些扩展、一些已知 bug 的修复、性能优化等。例如：同样使用 node 跑一次测试用例，node10 版本比 node6 版本构建时间要缩短 50% 以上。")]),a._v(" "),e("p",[e("strong",[a._v("利于维护")]),a._v("：新版本的库都是最新的文档，查阅比较方便，如果遇到项目交接给一个新手，可以避免去学习一些老版本的语法，降低交接难度。")]),a._v(" "),e("h2",{attrs:{id:"如何升级依赖包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何升级依赖包"}},[a._v("#")]),a._v(" 如何升级依赖包")]),a._v(" "),e("p",[a._v("这里分享 4 种方法，可以方便我们更新项目依赖包。")]),a._v(" "),e("p",[a._v("1、使用 npm 源生方法。")]),a._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" update package_xxx\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("这种方法源生支持，不需要装额外的包，但是一次只能更新一个包，且会受到包版本规则的影响，所以基本很少用。")]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("npm 包版本号规则")]),a._v(" "),e("ul",[e("li",[a._v("~1.0.0 匹配 1.0.x")]),a._v(" "),e("li",[a._v("^1.0.0 匹配 1.x.x")]),a._v(" "),e("li",[a._v("1.0.0 匹配 1.0.0")]),a._v(" "),e("li",[a._v(">1.0.0 匹配大于 1.0.0")]),a._v(" "),e("li",[a._v("<1.0.0 匹配小于 1.0.0")]),a._v(" "),e("li",[a._v("* 匹配任何版本")]),a._v(" "),e("li",[a._v("latest 匹配最新版本")])])]),a._v(" "),e("p",[a._v("2、使用 npm-check-updates，自动将所有 package.json 中的包更新为最新版。")]),a._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 全局安装")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" i npm-check-updates "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-g")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在项目根目录执行命令")]),a._v("\nncu "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("p",[a._v("3、使用自动化依赖包升级工具 "),e("a",{attrs:{href:"https://greenkeeper.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("greenkeeper"),e("OutboundLink")],1),a._v("。")]),a._v(" "),e("p",[a._v("这个工具通常配合 github 使用，选定指定项目，它会解析你的 package.json 文件，当有更新的依赖包被加载进来的时候，就会提交一个 Pull requests，这会触发 ci 构建，如果 ci 没什么问题，直接合并就好了。")]),a._v(" "),e("p",[a._v("如果 ci 有问题，证明新的依赖包可能更改了语法，或者不向下兼容了，"),e("strong",[a._v("我们可以第一时间发现问题并处理")]),a._v("，而不必等到依赖包更新太多导致语法差异越来越大，到时候再想兼容新版本可就要费一番心思了。")]),a._v(" "),e("p",[a._v("4、如果你的依赖都是最新的，还可以在 "),e("a",{attrs:{href:"https://david-dm.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("David"),e("OutboundLink")],1),a._v("上添加小图标哦！")]),a._v(" "),e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结")]),a._v(" "),e("p",[a._v("关于是不是应该保持项目依赖的问题，我个人建议是：")]),a._v(" "),e("ul",[e("li",[a._v("使用自动化工具自动更新，\n"),e("ul",[e("li",[a._v("单元测试通过，合并到项目中。")]),a._v(" "),e("li",[a._v("单元测试不通过，及时查看报错信息，判断修改难度。\n"),e("ul",[e("li",[a._v("难度小，例如：官方弃用了旧的 api，同时提供了新的 api 来代替，则需要及时进行更新。")]),a._v(" "),e("li",[a._v("难度大，例如：官方重构了项目，api 结构、使用方式都发生了改变，则可以不进行更新。")])])])])])]),a._v(" "),e("h2",{attrs:{id:"参考地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考地址"}},[a._v("#")]),a._v(" 参考地址")]),a._v(" "),e("p",[e("a",{attrs:{href:"http://blog.js-republic.com/keep-npm-dependencies-up-to-date/",target:"_blank",rel:"noopener noreferrer"}},[a._v("HOW TO KEEP HIS NPM DEPENDENCIES UP-TO-DATE ?"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("a",{attrs:{href:"https://semver.org/lang/zh-CN/",target:"_blank",rel:"noopener noreferrer"}},[a._v("版本号规范"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);